function plot_fractions(saveFlag, debugFlag)
tic;

Z_0_0200 = load('../data/fraction_Z_0.02.mat');
Z_0_0142 = load('../data/fraction_Z_0.0142.mat');
Z_0_0100 = load('../data/fraction_Z_0.01.mat');
Z_0_0047 = load('../data/fraction_Z_0.0047.mat');
Z_0_0021 = load('../data/fraction_Z_0.0021.mat');
Z_0_0010 = load('../data/fraction_Z_0.001.mat');
Z_0_0002 = load('../data/fraction_Z_0.0002.mat');
Z_0_0001 = load('../data/fraction_Z_0.0001.mat');

metallicity             = [ 0.0200 ...
                            0.0142 ...
                            0.0100 ...
                            0.0047 ...
                            0.0021 ...
                            0.0010 ...
                            0.0002 ...
                            0.0001];
% Speed limit 50 km/s
% Single
single_fraction_mass_5_speed_50   = [  Z_0_0200.single_fraction_mass_5_speed_50 ...
                                Z_0_0142.single_fraction_mass_5_speed_50 ...
                                Z_0_0100.single_fraction_mass_5_speed_50 ...
                                Z_0_0047.single_fraction_mass_5_speed_50 ...
                                Z_0_0021.single_fraction_mass_5_speed_50 ...
                                Z_0_0010.single_fraction_mass_5_speed_50 ...
                                Z_0_0002.single_fraction_mass_5_speed_50 ...
                                Z_0_0001.single_fraction_mass_5_speed_50];

single_fraction_mass_10_speed_50   = [ Z_0_0200.single_fraction_mass_10_speed_50 ...
                                Z_0_0142.single_fraction_mass_10_speed_50 ...
                                Z_0_0100.single_fraction_mass_10_speed_50 ...
                                Z_0_0047.single_fraction_mass_10_speed_50 ...
                                Z_0_0021.single_fraction_mass_10_speed_50 ...
                                Z_0_0010.single_fraction_mass_10_speed_50 ...
                                Z_0_0002.single_fraction_mass_10_speed_50 ...
                                Z_0_0001.single_fraction_mass_10_speed_50];

single_fraction_mass_15_speed_50   = [ Z_0_0200.single_fraction_mass_15_speed_50 ...
                                Z_0_0142.single_fraction_mass_15_speed_50 ...
                                Z_0_0100.single_fraction_mass_15_speed_50 ...
                                Z_0_0047.single_fraction_mass_15_speed_50 ...
                                Z_0_0021.single_fraction_mass_15_speed_50 ...
                                Z_0_0010.single_fraction_mass_15_speed_50 ...
                                Z_0_0002.single_fraction_mass_15_speed_50 ...
                                Z_0_0001.single_fraction_mass_15_speed_50];

single_fraction_mass_20_speed_50   = [ Z_0_0200.single_fraction_mass_20_speed_50 ...
                                Z_0_0142.single_fraction_mass_20_speed_50 ...
                                Z_0_0100.single_fraction_mass_20_speed_50 ...
                                Z_0_0047.single_fraction_mass_20_speed_50 ...
                                Z_0_0021.single_fraction_mass_20_speed_50 ...
                                Z_0_0010.single_fraction_mass_20_speed_50 ...
                                Z_0_0002.single_fraction_mass_20_speed_50 ...
                                Z_0_0001.single_fraction_mass_20_speed_50];

single_fraction_mass_100_speed_50   = [ Z_0_0200.single_fraction_mass_100_speed_50 ...
                                 Z_0_0142.single_fraction_mass_100_speed_50 ...
                                 Z_0_0100.single_fraction_mass_100_speed_50 ...
                                 Z_0_0047.single_fraction_mass_100_speed_50 ...
                                 Z_0_0021.single_fraction_mass_100_speed_50 ...
                                 Z_0_0010.single_fraction_mass_100_speed_50 ...
                                 Z_0_0002.single_fraction_mass_100_speed_50 ...
                                 Z_0_0001.single_fraction_mass_100_speed_50];

% Binary
binary_fraction_mass_5_speed_50   = [  Z_0_0200.binary_fraction_mass_5_speed_50 ...
                                Z_0_0142.binary_fraction_mass_5_speed_50 ...
                                Z_0_0100.binary_fraction_mass_5_speed_50 ...
                                Z_0_0047.binary_fraction_mass_5_speed_50 ...
                                Z_0_0021.binary_fraction_mass_5_speed_50 ...
                                Z_0_0010.binary_fraction_mass_5_speed_50 ...
                                Z_0_0002.binary_fraction_mass_5_speed_50 ...
                                Z_0_0001.binary_fraction_mass_5_speed_50];

binary_fraction_mass_10_speed_50   = [ Z_0_0200.binary_fraction_mass_10_speed_50 ...
                                Z_0_0142.binary_fraction_mass_10_speed_50 ...
                                Z_0_0100.binary_fraction_mass_10_speed_50 ...
                                Z_0_0047.binary_fraction_mass_10_speed_50 ...
                                Z_0_0021.binary_fraction_mass_10_speed_50 ...
                                Z_0_0010.binary_fraction_mass_10_speed_50 ...
                                Z_0_0002.binary_fraction_mass_10_speed_50 ...
                                Z_0_0001.binary_fraction_mass_10_speed_50];

binary_fraction_mass_15_speed_50   = [ Z_0_0200.binary_fraction_mass_15_speed_50 ...
                                Z_0_0142.binary_fraction_mass_15_speed_50 ...
                                Z_0_0100.binary_fraction_mass_15_speed_50 ...
                                Z_0_0047.binary_fraction_mass_15_speed_50 ...
                                Z_0_0021.binary_fraction_mass_15_speed_50 ...
                                Z_0_0010.binary_fraction_mass_15_speed_50 ...
                                Z_0_0002.binary_fraction_mass_15_speed_50 ...
                                Z_0_0001.binary_fraction_mass_15_speed_50];

binary_fraction_mass_20_speed_50   = [ Z_0_0200.binary_fraction_mass_20_speed_50 ...
                                Z_0_0142.binary_fraction_mass_20_speed_50 ...
                                Z_0_0100.binary_fraction_mass_20_speed_50 ...
                                Z_0_0047.binary_fraction_mass_20_speed_50 ...
                                Z_0_0021.binary_fraction_mass_20_speed_50 ...
                                Z_0_0010.binary_fraction_mass_20_speed_50 ...
                                Z_0_0002.binary_fraction_mass_20_speed_50 ...
                                Z_0_0001.binary_fraction_mass_20_speed_50];

binary_fraction_mass_100_speed_50   = [ Z_0_0200.binary_fraction_mass_100_speed_50 ...
                                 Z_0_0142.binary_fraction_mass_100_speed_50 ...
                                 Z_0_0100.binary_fraction_mass_100_speed_50 ...
                                 Z_0_0047.binary_fraction_mass_100_speed_50 ...
                                 Z_0_0021.binary_fraction_mass_100_speed_50 ...
                                 Z_0_0010.binary_fraction_mass_100_speed_50 ...
                                 Z_0_0002.binary_fraction_mass_100_speed_50 ...
                                 Z_0_0001.binary_fraction_mass_100_speed_50];

fraction_abs_BH_sin_mass_2_5_speed_50   = [ Z_0_0200.fraction_abs_BH_sin_mass_2_5_speed_50 ...
                                 Z_0_0142.fraction_abs_BH_sin_mass_2_5_speed_50 ...
                                 Z_0_0100.fraction_abs_BH_sin_mass_2_5_speed_50 ...
                                 Z_0_0047.fraction_abs_BH_sin_mass_2_5_speed_50 ...
                                 Z_0_0021.fraction_abs_BH_sin_mass_2_5_speed_50 ...
                                 Z_0_0010.fraction_abs_BH_sin_mass_2_5_speed_50 ...
                                 Z_0_0002.fraction_abs_BH_sin_mass_2_5_speed_50 ...
                                 Z_0_0001.fraction_abs_BH_sin_mass_2_5_speed_50];

fraction_abs_BH_sin_mass_5_speed_50   = [ Z_0_0200.fraction_abs_BH_sin_mass_5_speed_50 ...
                                 Z_0_0142.fraction_abs_BH_sin_mass_5_speed_50 ...
                                 Z_0_0100.fraction_abs_BH_sin_mass_5_speed_50 ...
                                 Z_0_0047.fraction_abs_BH_sin_mass_5_speed_50 ...
                                 Z_0_0021.fraction_abs_BH_sin_mass_5_speed_50 ...
                                 Z_0_0010.fraction_abs_BH_sin_mass_5_speed_50 ...
                                 Z_0_0002.fraction_abs_BH_sin_mass_5_speed_50 ...
                                 Z_0_0001.fraction_abs_BH_sin_mass_5_speed_50];

fraction_abs_BH_sin_mass_10_speed_50   = [ Z_0_0200.fraction_abs_BH_sin_mass_10_speed_50 ...
                                 Z_0_0142.fraction_abs_BH_sin_mass_10_speed_50 ...
                                 Z_0_0100.fraction_abs_BH_sin_mass_10_speed_50 ...
                                 Z_0_0047.fraction_abs_BH_sin_mass_10_speed_50 ...
                                 Z_0_0021.fraction_abs_BH_sin_mass_10_speed_50 ...
                                 Z_0_0010.fraction_abs_BH_sin_mass_10_speed_50 ...
                                 Z_0_0002.fraction_abs_BH_sin_mass_10_speed_50 ...
                                 Z_0_0001.fraction_abs_BH_sin_mass_10_speed_50];

fraction_abs_BH_sin_mass_15_speed_50   = [ Z_0_0200.fraction_abs_BH_sin_mass_15_speed_50 ...
                                 Z_0_0142.fraction_abs_BH_sin_mass_15_speed_50 ...
                                 Z_0_0100.fraction_abs_BH_sin_mass_15_speed_50 ...
                                 Z_0_0047.fraction_abs_BH_sin_mass_15_speed_50 ...
                                 Z_0_0021.fraction_abs_BH_sin_mass_15_speed_50 ...
                                 Z_0_0010.fraction_abs_BH_sin_mass_15_speed_50 ...
                                 Z_0_0002.fraction_abs_BH_sin_mass_15_speed_50 ...
                                 Z_0_0001.fraction_abs_BH_sin_mass_15_speed_50];

fraction_abs_BH_sin_mass_20_speed_50   = [ Z_0_0200.fraction_abs_BH_sin_mass_20_speed_50 ...
                                 Z_0_0142.fraction_abs_BH_sin_mass_20_speed_50 ...
                                 Z_0_0100.fraction_abs_BH_sin_mass_20_speed_50 ...
                                 Z_0_0047.fraction_abs_BH_sin_mass_20_speed_50 ...
                                 Z_0_0021.fraction_abs_BH_sin_mass_20_speed_50 ...
                                 Z_0_0010.fraction_abs_BH_sin_mass_20_speed_50 ...
                                 Z_0_0002.fraction_abs_BH_sin_mass_20_speed_50 ...
                                 Z_0_0001.fraction_abs_BH_sin_mass_20_speed_50];

if debugFlag
    single_fraction_mass_5_speed_50
    single_fraction_mass_10_speed_50
    single_fraction_mass_15_speed_50
    single_fraction_mass_20_speed_50
    single_fraction_mass_100_speed_50
    binary_fraction_mass_5_speed_50
    binary_fraction_mass_10_speed_50
    binary_fraction_mass_15_speed_50
    binary_fraction_mass_20_speed_50
    binary_fraction_mass_100_speed_50
    fraction_abs_BH_sin_mass_2_5_speed_50
    fraction_abs_BH_sin_mass_5_speed_50
    fraction_abs_BH_sin_mass_10_speed_50
    fraction_abs_BH_sin_mass_15_speed_50
    fraction_abs_BH_sin_mass_20_speed_50
end

% Plot
figure()
fs=18;
lw=2.0;
string1='Z';  

% Single
hold on
xticks([0.0001 0.005 0.01 0.015 0.02])
ylim([0.1 1])
xlabel(string1,'FontSize',fs,'FontName','Times New Roman')
ax=gca;
ax.FontSize=fs;
ax.FontName = 'Times New Roman';
box on

plot(metallicity,fraction_abs_BH_sin_mass_5_speed_50,'k','LineWidth',lw)
plot(metallicity,fraction_abs_BH_sin_mass_10_speed_50,'--k','LineWidth',lw)
plot(metallicity,fraction_abs_BH_sin_mass_15_speed_50,':k','LineWidth',lw)
plot(metallicity,fraction_abs_BH_sin_mass_20_speed_50,'-.k','LineWidth',lw)
ylabel('N_{sin} / N_{tot}','FontSize',fs,'FontName','Times New Roman')
legend( '$M \geq 5\ \rm{M_{\odot}}$',...
        '$M \geq 10\ \rm{M_{\odot}}$',...
        '$M \geq 15\ \rm{M_{\odot}}$',...        
        '$M \geq 20\ \rm{M_{\odot}}$',...
        'Location','SouthEast',...
        'Interpreter','latex',...
        'box','off')

if saveFlag
    print(gcf,strcat('../plots/png/figure5_single.png'),'-dpng','-r300');
    saveas(gcf,strcat('../plots/pdf/figure5_single.pdf'))
end

% Binary
figure()
hold on
xticks([0.0001 0.005 0.01 0.015 0.02])
ylim([0.1 1])
xlabel(string1,'FontSize',fs,'FontName','Times New Roman')
ax=gca;
ax.FontSize=fs;
ax.FontName = 'Times New Roman';
box on

plot(metallicity,binary_fraction_mass_5_speed_50,'k','LineWidth',lw)
plot(metallicity,binary_fraction_mass_10_speed_50,'--k','LineWidth',lw)
plot(metallicity,binary_fraction_mass_15_speed_50,':k','LineWidth',lw)
plot(metallicity,binary_fraction_mass_20_speed_50,'-.k','LineWidth',lw)
ylabel('N_{bin} / N_{tot}','FontSize',fs,'FontName','Times New Roman')
legend( '$M \leq 5\ \rm{M_{\odot}}$',...
        '$M \leq 10\ \rm{M_{\odot}}$',...
        '$M \leq 15\ \rm{M_{\odot}}$',...
        '$M \leq 20\ \rm{M_{\odot}}$',...
        'Location','SouthEast',...
        'Interpreter','latex',...
        'box','off')

if saveFlag
    print(gcf,strcat('../plots/png/figure5_binary.png'),'-dpng','-r300');
    saveas(gcf,strcat('../plots/pdf/figure5_binary.pdf'))
end


toc;
end